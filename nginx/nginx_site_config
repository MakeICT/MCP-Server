server {
    # listen on port 80 (http)
    # listen 80;
    # server_name _;
    # location / {
    #     # redirect any requests to the same URL but on https
    #     return 301 https://\$host\$request_uri;
    # }
    # listen on port 80 (http)
    listen 80;
    server_name makeict.org security.makeict.org;

    # write access and error logs to ${INSTALL_DIR}/log
    # access_log /home/mcp/log/master_control_program_access.log;
    # error_log /home/mcp/log/master_control_program_error.log;

    location / {
        # forward application requests to the gunicorn server
        proxy_pass http://flask:8000;
        proxy_redirect off;
        proxy_set_header Host \$host;
        proxy_set_header X-Real-IP \$remote_addr;
        proxy_set_header X-Forwarded-For \$proxy_add_x_forwarded_for;
    }

    location /clients/socket {
        proxy_pass http://flask:8000/clients/socket;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
    }

    # Might want to fix this so nginx can directly serve static files
    # location /static {
    #     # handle static files directly, without forwarding to the application
    #     proxy_pass http://flask:8000;
    #     expires 30d;
    # }
}
# server {
#     # listen on port 443 (https)
#     listen 443 ssl;
#     server_name $DOMAIN_NAME $SERVER_NAME;

#     # write access and error logs to ${INSTALL_DIR}/log
#     access_log /home/mcp/log/master_control_program_access.log;
#     error_log /home/mcp/log/master_control_program_error.log;

#     location / {
#         # forward application requests to the gunicorn server
#         proxy_pass http://flask:8000;
#         proxy_redirect off;
#         proxy_set_header Host \$host;
#         proxy_set_header X-Real-IP \$remote_addr;
#         proxy_set_header X-Forwarded-For \$proxy_add_x_forwarded_for;
#     }

#     location /clients/socket {
#         proxy_pass http://flask:8000/clients/socket;
#         proxy_http_version 1.1;
#         proxy_set_header Upgrade $http_upgrade;
#         proxy_set_header Connection "upgrade";
#     }

#     location /static {
#         # handle static files directly, without forwarding to the application
#         alias /home/mcp/src/mcp/static;
#         expires 30d;
#     }

# }
